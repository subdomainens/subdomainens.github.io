<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SubdomainENS</title>
      <link rel="stylesheet" href="css/style.css">
</head>

<style>
.button {
    background-color: #2e5151; 
    border: none;
    color: white;
    padding: 10px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}

.btn{
    background-color: #454f4f; 
    border: none;
    color: white;
    padding: 5px 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}

button {

    background: transparent;
    border: none !important;
    color: white;
    cursor: pointer;
}â€‹
</style>

<body>

<style>

input{
  font-size:15px;
  padding:8px 10px;
  margin:8px;
}
</style>

  <div id='browser'>
  <div id='browser-bar'>
    <div class='circles'></div>
    <div class='circles'></div>
    <div class='circles'></div>
    <p><b>SubdomainENS</b></p>
   <span class='arrow entypo-resize-full'></span>
  </div>
  <div id='content'>
    <div id='left'>
     
     <div id="sendETH" class="tabcontent" style="display:none;">
      <div id='map'>     
          <center><p><button  onclick="tabClose()">Send ETH</button></p></center>   
        <p></p>
<center><input type="text" id="ETHfrom" placeholder="From Address"></input></center>
 <center><input type="text" id="ETHto"  placeholder="To Address"> </input></center>
 <center><input type="text" id="ETHValue"   placeholder="Value (ETH)"> </input></center>
    <center><button type="button" class="button" onclick="sendETH()" id="point">Send</button></center>

      </div>
     </div>


<div id="sellName" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Sell Subdomains</button></p></center>   
        <p></p>
<center><input type="text" id="seller" style="padding:4px 10px;" placeholder="Your ETH Address"></input></center>
 <center><input type="text" id="namesell"  style="padding:4px 10px;" placeholder="ENS Name"> </input></center>
 <center><input type="text" id="commitPeriod"   style="padding:4px 10px;"placeholder="Commit Period (s)"> </input></center>
 <center><input type="text" id="nameexpiry"   style="padding:4px 10px;"placeholder="Expiry (s)"> </input></center>
 <center><input type="text" id="nameprice"   style="padding:4px 10px;"placeholder="Price (ETH)"> </input></center>

    <center><span><button type="button" class="button" style="padding: 10px 32px;" onclick="assignment()" id="point">List</button>
    <button type="button" class="button" style="padding: 10px 32px;" onclick="finalize()" id="point">Finalize</button></span></center>
      </div>
     </div>

 <div id="nameUnlist" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Unlist ENS Name</button></p></center>   
        <p></p>

<center><input type="text" id="origOwner" placeholder="Owner Address"></input></center>
<center><input type="text" id="unlistEName" placeholder="ENS Name"></input></center>
    <center><button type="button" class="button" onclick="unlist();"" id="point">Unlist</button></center>

      </div>
     </div>



<div id="buyName" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Buy Subdomains</button></p></center>   
        <p></p>
<center><input type="text" id="buyer" style="padding:4px 10px;" placeholder="Your ETH Address"></input></center>
 <center><input type="text" id="regbuyername"  style="padding:4px 10px;" placeholder="ENS Name"> </input></center>
 <center><input type="text" id="buynameprice"   style="padding:4px 10px;"placeholder="Price (ETH)"> </input></center>
  <center><button type="button" class="button" style="padding: 10px 32px;" onclick="buy()" id="point">Buy</button></span></center>
      </div>
     </div>

 <div id="nameInfo" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Name Information</button></p></center>   
        <p></p>
<div style="position: relative;top: 50%;transform: translateY(-80%);">
<center><input type="text" id="ename" placeholder="ENS Name"></input></center>
    <center><button type="button" class="button" onclick="check();openDiv(event, 'NameOwner');"" id="point">Search</button></center>
</div>
      </div>
     </div>

<div id="NameOwner" class="tabcontent" style="display:none;">
      <div id='map'>
<p></p>
<div>
<p style="font-size:20px!important;">Subdomains</p>
<p>Owner: <span class="owner"></span></p>
<p>Expiry: <span class="subexpiry"></span></p>
<p>For Sale: <span class="subavailability"></span></p>
<p>Price: <span class="subPrice"></span></p>
</div>
<p></p>
</div>
</div>

<div id="SetUp" class="tabcontent" style="display:none;">
      <div id='map'>
          
</div>
</div>

<div id="resolveName" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Resolve Name</button></p></center>   
        <p></p>
<center><input type="text" id="origETH" placeholder="From Address"></input></center>
 <center><input type="text" id="destETH"  placeholder="To Address"> </input></center>
 <center><input type="text" id="resENS"   placeholder="ENS Name"> </input></center>
    <center><button type="button" class="button" onclick="resolve()" id="point">Resolve</button></center>

      </div>
     </div>

 <div id="resCheck" class="tabcontent" style="display:none;">
      <div id='map'>
          <center><p><button  onclick="tabClose()">Resolver Check</button></p></center>   
        <p></p>
<div style="position: relative;top: 50%;transform: translateY(-80%);">
<center><input type="text" id="resCheckName" placeholder="ENS Name"></input></center>
    <center><button type="button" class="button" onclick="resCheck();openDiv(event, 'AddResolver');"" id="point">Check</button></center>
</div>
      </div>
     </div>

<div id="AddResolver" class="tabcontent" style="display:none;">
<div id='map'>
<p></p>
<div style="position: relative;top: 50%;transform: translateY(-80%);">
<center><p>ENS Name Points To: <span class="resPoint"></span></p></center>
</div>
</div>
</div>

<div class="tabcontent" style="display:none;">
</div>

<div class="topnav" id="myTopnav">
      <ul id='location-bar' style="padding: 10px 32px;">
        <li>
          <button  onclick="openDiv(event, 'sendETH')">Send ETH</button>
        </li>
        <li>
          <button  onclick="openDiv(event, 'sellName')">Sell Name</button>
        </li>
        <li>
          <button  onclick="openDiv(event, 'nameUnlist')">Unlist Name</button>
        </li>
        <li>
          <button  onclick="openDiv(event, 'buyName')">Buy Name</button>
        </li>
          <li>
          <button  onclick="openDiv(event, 'nameInfo')">Name Information</button>
        </li> 
        <li>
          <button  onclick="openDiv(event, 'resolveName')">Resolve Name</button>
        </li>
       <li>
          <button  onclick="openDiv(event, 'resCheck')">Resolver Check</button>
        </li>
      </ul>
    </div>
    </div>

    <div id='right'>
      <p><a href="https://discord.gg/u6aMm33">Discord Invitation</a></p>
      <form>
      <p>How This Works
<p><button type="button" class="btn"  onclick="openDiv(event, 'SetUp')">Open Guide</button>
     </form>
    </div>
  </div>
</div>
<script src="https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script>
function toWei(num){
  return num*1.0e18;
}
</script>
<script>
function tabClose(){
 tabcontent = document.getElementsByClassName("tabcontent");
 for (i = 0; i < tabcontent.length; i++) {
   tabcontent[i].style.display = "none";
  }
}
</script>
<script>
function openDiv(evt, cityName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
}
</script>
<script>
$(function(){
  $('input').bind('input', function(){
    $(this).val(function(_, v){
      return v.replace(/\s+/g, '');
    });
  });
});
</script>
<script>
function timeConverter(UNIX_timestamp){
  var a = new Date(UNIX_timestamp * 1000);
  var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  var year = a.getFullYear();
  var month = months[a.getMonth()];
  var date = a.getDate();
  var hour = a.getHours();
  var min = a.getMinutes() < 10 ? '0' + a.getMinutes() : a.getMinutes();
  var sec = a.getSeconds() < 10 ? '0' + a.getSeconds() : a.getSeconds();
  var time = date + ' ' + month + ' ' + year + ' ' + hour + ':' + min + ':' + sec ;
  return time;
}
</script>
<script>
function empty2(id){
  inputs = document.getElementById(id).getElementsByTagName('input')
  for (i = 0; i < inputs.length; i++) {
    if(inputs[i].value=="" || inputs[i].value==undefined){
      alert("Oops! Empty Input.")
      return false
      break;
     }
   }
  return true;
}
</script>
<script>
var ensabi = JSON.parse('[ { "constant": true, "inputs": [ { "name": "node", "type": "bytes32" } ], "name": "resolver", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "type": "function" }, { "constant": true, "inputs": [ { "name": "node", "type": "bytes32" } ], "name": "owner", "outputs": [ { "name": "", "type": "address" } ], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "node", "type": "bytes32" }, { "name": "label", "type": "bytes32" }, { "name": "owner", "type": "address" } ], "name": "setSubnodeOwner", "outputs": [], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "node", "type": "bytes32" }, { "name": "ttl", "type": "uint64" } ], "name": "setTTL", "outputs": [], "payable": false, "type": "function" }, { "constant": true, "inputs": [ { "name": "node", "type": "bytes32" } ], "name": "ttl", "outputs": [ { "name": "", "type": "uint64" } ], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "node", "type": "bytes32" }, { "name": "resolver", "type": "address" } ], "name": "setResolver", "outputs": [], "payable": false, "type": "function" }, { "constant": false, "inputs": [ { "name": "node", "type": "bytes32" }, { "name": "owner", "type": "address" } ], "name": "setOwner", "outputs": [], "payable": false, "type": "function" }, { "inputs": [], "payable": false, "type": "constructor" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "node", "type": "bytes32" }, { "indexed": true, "name": "label", "type": "bytes32" }, { "indexed": false, "name": "owner", "type": "address" } ], "name": "NewOwner", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "node", "type": "bytes32" }, { "indexed": false, "name": "owner", "type": "address" } ], "name": "Transfer", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "node", "type": "bytes32" }, { "indexed": false, "name": "resolver", "type": "address" } ], "name": "NewResolver", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "node", "type": "bytes32" }, { "indexed": false, "name": "ttl", "type": "uint64" } ], "name": "NewTTL", "type": "event" } ]');
var resabi =  JSON.parse('[{"constant":true,"inputs":[{"name":"interfaceID","type":"bytes4"}],"name":"supportsInterface","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"node","type":"bytes32"},{"name":"contentTypes","type":"uint256"}],"name":"ABI","outputs":[{"name":"contentType","type":"uint256"},{"name":"data","type":"bytes"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"},{"name":"x","type":"bytes32"},{"name":"y","type":"bytes32"}],"name":"setPubkey","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"node","type":"bytes32"}],"name":"content","outputs":[{"name":"ret","type":"bytes32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"node","type":"bytes32"}],"name":"addr","outputs":[{"name":"ret","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"},{"name":"contentType","type":"uint256"},{"name":"data","type":"bytes"}],"name":"setABI","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"node","type":"bytes32"}],"name":"name","outputs":[{"name":"ret","type":"string"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"},{"name":"name","type":"string"}],"name":"setName","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"},{"name":"hash","type":"bytes32"}],"name":"setContent","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"node","type":"bytes32"}],"name":"pubkey","outputs":[{"name":"x","type":"bytes32"},{"name":"y","type":"bytes32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"},{"name":"addr","type":"address"}],"name":"setAddr","outputs":[],"payable":false,"type":"function"},{"inputs":[{"name":"ensAddr","type":"address"}],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"node","type":"bytes32"},{"indexed":false,"name":"a","type":"address"}],"name":"AddrChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"node","type":"bytes32"},{"indexed":false,"name":"hash","type":"bytes32"}],"name":"ContentChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"node","type":"bytes32"},{"indexed":false,"name":"name","type":"string"}],"name":"NameChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"node","type":"bytes32"},{"indexed":true,"name":"contentType","type":"uint256"}],"name":"ABIChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"node","type":"bytes32"},{"indexed":false,"name":"x","type":"bytes32"},{"indexed":false,"name":"y","type":"bytes32"}],"name":"PubkeyChanged","type":"event"}]');
var regabi = JSON.parse('[{"constant":false,"inputs":[{"name":"label","type":"bytes32"},{"name":"node","type":"bytes32"},{"name":"commit","type":"uint256"},{"name":"price","type":"uint256"},{"name":"expiry","type":"uint256"}],"name":"listSubName","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"checkCommitPeriod","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"label","type":"bytes32"},{"name":"node","type":"bytes32"}],"name":"unlistSubName","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"subRegistrationPeriod","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"nodeCheck","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"checkSubPrice","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"checkSubAvailability","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"ensName","type":"bytes32"},{"name":"subNode","type":"bytes32"},{"name":"newOwner","type":"address"}],"name":"subBuy","outputs":[],"payable":true,"type":"function"},{"constant":false,"inputs":[{"name":"node","type":"bytes32"}],"name":"checkRegPeriod","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"},{"payable":true,"type":"fallback"}]'); 

var mainregabi = JSON.parse('[{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"releaseDeed","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"getAllowedTime","outputs":[{"name":"timestamp","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"unhashedName","type":"string"}],"name":"invalidateName","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"hash","type":"bytes32"},{"name":"owner","type":"address"},{"name":"value","type":"uint256"},{"name":"salt","type":"bytes32"}],"name":"shaBid","outputs":[{"name":"sealedBid","type":"bytes32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"bidder","type":"address"},{"name":"seal","type":"bytes32"}],"name":"cancelBid","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"entries","outputs":[{"name":"","type":"uint8"},{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"ens","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"},{"name":"_value","type":"uint256"},{"name":"_salt","type":"bytes32"}],"name":"unsealBid","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"transferRegistrars","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"},{"name":"","type":"bytes32"}],"name":"sealedBids","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"state","outputs":[{"name":"","type":"uint8"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"},{"name":"newOwner","type":"address"}],"name":"transfer","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_hash","type":"bytes32"},{"name":"_timestamp","type":"uint256"}],"name":"isAllowed","outputs":[{"name":"allowed","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"finalizeAuction","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"registryStarted","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"launchLength","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"sealedBid","type":"bytes32"}],"name":"newBid","outputs":[],"payable":true,"type":"function"},{"constant":false,"inputs":[{"name":"labels","type":"bytes32[]"}],"name":"eraseNode","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hashes","type":"bytes32[]"}],"name":"startAuctions","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"hash","type":"bytes32"},{"name":"deed","type":"address"},{"name":"registrationDate","type":"uint256"}],"name":"acceptRegistrarTransfer","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_hash","type":"bytes32"}],"name":"startAuction","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"rootNode","outputs":[{"name":"","type":"bytes32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"hashes","type":"bytes32[]"},{"name":"sealedBid","type":"bytes32"}],"name":"startAuctionsAndBid","outputs":[],"payable":true,"type":"function"},{"inputs":[{"name":"_ens","type":"address"},{"name":"_rootNode","type":"bytes32"},{"name":"_startDate","type":"uint256"}],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":false,"name":"registrationDate","type":"uint256"}],"name":"AuctionStarted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":true,"name":"bidder","type":"address"},{"indexed":false,"name":"deposit","type":"uint256"}],"name":"NewBid","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":true,"name":"owner","type":"address"},{"indexed":false,"name":"value","type":"uint256"},{"indexed":false,"name":"status","type":"uint8"}],"name":"BidRevealed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":true,"name":"owner","type":"address"},{"indexed":false,"name":"value","type":"uint256"},{"indexed":false,"name":"registrationDate","type":"uint256"}],"name":"HashRegistered","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":false,"name":"value","type":"uint256"}],"name":"HashReleased","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"hash","type":"bytes32"},{"indexed":true,"name":"name","type":"string"},{"indexed":false,"name":"value","type":"uint256"},{"indexed":false,"name":"registrationDate","type":"uint256"}],"name":"HashInvalidated","type":"event"}]');

var myens = web3.eth.contract(ensabi).at("0x314159265dD8dbb310642f98f50C066173C1259b")
var myres = web3.eth.contract(resabi).at("0x1da022710dF5002339274AaDEe8D58218e9D6AB5")
var myreg = web3.eth.contract(regabi).at("0x163C90d093109DcCAa0EfB55410B105Eeb9fa02D")
var mainreg = web3.eth.contract(mainregabi).at("0x6090A6e47849629b7245Dfa1Ca21D94cd15878Ef")

function sendETH(){
  if(empty2("sendETH") == true){
    var from = $('#ETHfrom').val() 
    var to = $('#ETHto').val()     
    if(from.substr(0,2).toLowerCase() !="0x"){
      from = myres.addr.call(ens.getNameHash(from))
     }
    if(to.substr(0,2).toLowerCase() !="0x"){
      to = myres.addr.call(ens.getNameHash(to))  
     } 
    var amount =  toWei(parseFloat($('#ETHValue').val()))  
    var Tx = {
      from: from,
      to: to, 
      value: amount
  }
  web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Transaction Successful");console.log("Transaction Successful. Transaction Hash: " + transactionHash);}});  
 }  
}

function buy(){
  if(empty2("buyName") == true){
    var buyer = $('#buyer').val()
    var fullName = $('#regbuyername').val().split(".")
    var regName  = ens.getNameHash(fullName.splice(1).join('.'));
    var ensName = web3.sha3(fullName[0])
    var price = toWei(parseFloat($('#buynameprice').val()))
    var mydata = myreg.subBuy.getData(regName,ensName,buyer)
    var Tx = {
      from: buyer,
      to: myreg.address,
      value: price,
      data: mydata
    }
    web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Successful Purchase");console.log("Transaction Successful. Transaction Hash: " + transactionHash);}});  
  }
}

function assignENS(){
  if(empty2("sellName") == true){
    var seller = $('#seller').val()
    var ensName = ens.getNameHash($('#namesell').val())
    var mydata = myens.setOwner.getData(ensName,myreg.address)
    var Tx = {
      from: seller,
      to: myens.address,
      data: mydata
    }
    web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Successful ENS Name Assignment");console.log("Successful ENS Name Assignment. Transaction Hash: " + transactionHash);}});
  }
}

function assignment(){
  if(empty2("sellName") == true){
    var seller = $('#seller').val()
    var label = web3.sha3($('#namesell').val().split(".")[0]) 
    var mydata = mainreg.transfer.getData(label,myreg.address)
    var Tx = {
      from: seller,
      to: myreg.address,
      data: mydata
    }
    web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Successful Deed Assignment");console.log("Successful Deed  Assignment. Transaction Hash: " + transactionHash);assignENS();}});
  }
}

function finalize(){
  if(empty2("sellName") == true){
  var ensName = ens.getNameHash($('#namesell').val())
  var label = web3.sha3($('#namesell').val().split(".")[0]) 
  var seller = $('#seller').val()
  var expiry = parseInt($('#nameexpiry').val())
  var commitPeriod = $('#commitPeriod').val()
  var price = toWei(parseFloat($('#nameprice').val()))
  var mydata = myreg.listSubName.getData(label,ensName,commitPeriod,price,expiry)
  var rawTx2 = {
    from: seller,
    to: myreg.address, 
    data: mydata
  }
  web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Successful Listing");console.log("Successful Listing. Transaction Hash: " + transactionHash);}});
  }
}

function unlist(){
  if(empty2("nameUnlist") == true){
  var ensName = ens.getNameHash($('#unlistEName').val())
  var unlistLabel = web3.sha3($('#unlistEName').val().split(".")[0])
  var origOwner = $('#origOwner').val()
  var key = globPrivKey
  var privkey = globalFuncs.myKeyBuffer(key)
  var mydata = myreg.unlistSubName.getData(unlistLabel,ensName)
  var Tx = {
    from: origOwner,
    to: myreg.address, 
    data: mydata
  }
  web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Successful Unlisting");console.log("Successful Unlisting. Transaction Hash: " + transactionHash);}});
  }  
 }

function check(){
    var data = ens.getNameHash($('#ename').val())
    if(myens.owner(data) == "0x0000000000000000000000000000000000000000"){
      $("span.owner").html("No Owner");
      $("span.subPrice").text("None");
      $("span.subexpiry").html("None");
      $("span.subavailability").text("No");
    }
    else{
      $("span.owner").html(myens.owner(data));
      $("span.subexpiry").html( parseInt(parseInt(myreg.subRegistrationPeriod.call(data).toString())/2592000).toString() + " months" );
      sprice = myreg.checkSubPrice.call(data)
      $("span.subPrice").text(sprice/1.0e18 + " ETH");
      sval = myreg.checkSubAvailability.call(data);
      $("span.subavailability").text(sval);
    }
      console.log(regabi);
 }

function resolve(){
  if(empty2("resolveName") == true){
    var from = $('#origETH').val()
    var dest = $('#destETH').val()
    var ensName = ens.getNameHash($('#resENS').val())
    var mydata = myres.setAddr.getData(ensName,dest)
    var Tx = {
      from: from,
      to: myres.address,  
      data: mydata
    }
    web3.eth.sendTransaction(Tx, function(err, transactionHash) {if (!err) {alert("Name Resolution Successful");console.log("Name Resolution Successful. Transaction Hash: " + transactionHash);}});
 }
}

function resCheck(){
    var data = ens.getNameHash($('#resCheckName').val())
    $("span.resPoint").text(myres.addr.call(data));
 }

</script>
</body>
</html>
